(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{381:function(e,a,t){e.exports=t.p+"assets/img/zarb-ansible.eba83a3c.png"},414:function(e,a,t){"use strict";t.r(a);var s=t(5),r=Object(s.a)({},(function(){var e=this,a=e.$createElement,s=e._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"deploy-using-ansible"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#deploy-using-ansible"}},[e._v("#")]),e._v(" Deploy using Ansible")]),e._v(" "),s("p",[e._v("In this tutorial you will learn how to deploy Zarb into your Virtual Private Server (VPS) without\ncompiling Zarb and using docker.")]),e._v(" "),s("h2",{attrs:{id:"üéÆ-what-is-ansible"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#üéÆ-what-is-ansible"}},[e._v("#")]),e._v(" üéÆ What is Ansible?")]),e._v(" "),s("div",{staticClass:"custom-block quote"},[s("p",[e._v("Ansible is all about automation, it requires instructions to accomplish each job. With everything\nwritten down in simple script form, it's easy to do version control.")]),e._v(" "),s("p",[e._v("In Ansible, there are two computers: the "),s("strong",[e._v("control node")]),e._v(" and "),s("strong",[e._v("managed nodes")]),e._v(". The control node is\nyour computer that runs Ansible. A managed node is any device being managed by the control node.")]),e._v(" "),s("div",{staticClass:"custom-block right"},[s("p",[e._v("From "),s("a",{attrs:{href:"https://opensource.com/resources/what-ansible",target:"_blank",rel:"noopener noreferrer"}},[e._v("OpenSource.com"),s("OutboundLink")],1)])])]),e._v(" "),s("p",[s("img",{attrs:{src:t(381),alt:"Deploy Zarb using ansible"}})]),e._v(" "),s("h2",{attrs:{id:"why-ansible"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#why-ansible"}},[e._v("#")]),e._v(" Why ansible?")]),e._v(" "),s("p",[e._v("Deploying Zarb is not a one time task. You may update the node time to time or change the\nconfiguration or even restart the node. Ansible helps you to automate the deployment process.")]),e._v(" "),s("h2",{attrs:{id:"step-by-step"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#step-by-step"}},[e._v("#")]),e._v(" Step by Step")]),e._v(" "),s("p",[e._v("Make sure you have installed\n"),s("a",{attrs:{href:"https://docs.ansible.com/ansible/latest/installation_guide/intro_installation.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Ansible"),s("OutboundLink")],1),e._v(" and\n"),s("a",{attrs:{href:"https://docs.docker.com/get-docker/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Docker"),s("OutboundLink")],1),e._v(" in your local machine and you have "),s("a",{attrs:{href:"https://www.google.com/search?q=access+to+your+server+through+SSH",target:"_blank",rel:"noopener noreferrer"}},[e._v("access to your\nserver through SSH"),s("OutboundLink")],1),e._v(".")]),e._v(" "),s("p",[e._v("Also if you have installed firewall in your server machine, make sure these port are open:")]),e._v(" "),s("ul",[s("li",[e._v("8421 for p2p network")]),e._v(" "),s("li",[e._v("8080 for gRPC gateway")]),e._v(" "),s("li",[e._v("9090 for gRPC")])]),e._v(" "),s("p",[e._v("First you need to clone this repository:")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("git clone https://github.com/b00f/zarb-deploy-ansible\ncd zarb-deploy-ansible\n")])])]),s("p",[e._v("Open "),s("code",[e._v("inventory.yml")]),e._v(" and update "),s("code",[e._v("ansible_host")]),e._v(" with your server remote ip address. something like:\n"),s("code",[e._v("root@11.22.33.44")]),e._v(".")]),e._v(" "),s("p",[e._v("Run "),s("code",[e._v("ansible all -m gather_facts")]),e._v(" to make sure ansible works fine.")]),e._v(" "),s("p",[e._v("Now, you need to generate two keys in your local machine. One for the validator and another for\ncollecting the rewards.")]),e._v(" "),s("Tabs",{attrs:{type:"border-card"}},[s("Tab",{attrs:{label:"ü™ü Window"}},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("docker run -i --rm -v c:\\zarb\\:/zarb zarb/zarb key generate -p /zarb/keystore/validator_key.json\ndocker run -i --rm -v c:\\zarb\\:/zarb zarb/zarb key generate -p /zarb/keystore/mintbase_key.json\n")])])]),s("p",[e._v("This command will generate new keys and save them at: "),s("code",[e._v("c:\\zarb\\keystore\\")])])]),e._v(" "),s("Tab",{attrs:{label:"üêß Linux and üçè Mac"}},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("docker run -i --rm -v ~/zarb/:/zarb zarb/zarb key generate -p /zarb/keystore/validator_key.json\ndocker run -i --rm -v ~/zarb/:/zarb zarb/zarb key generate -p /zarb/keystore/mintbase_key.json\n")])])]),s("p",[e._v("This command will generate new keys and save them at: "),s("code",[e._v("~/zarb/keystore/")])])])],1),e._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[e._v("WARNING")]),e._v(" "),s("p",[e._v("Make sure you write down the Mnemonics of your keys. You can recover your keys from Mnemonics, if\nyou lose them.")]),e._v(" "),s("p",[e._v("You should know that you are responsible for the safety of your key.")])]),e._v(" "),s("p",[e._v("To store and send validator private key to server, we use\n"),s("a",{attrs:{href:"https://docs.ansible.com/ansible/latest/user_guide/vault.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Ansible vault"),s("OutboundLink")],1),e._v(". Ansible Vault\nencrypts variables so you can protect sensitive content such as secret keys.")]),e._v(" "),s("p",[e._v("Before creating Ansible Vault, you need to know the private key for the validator. Using\n"),s("code",[e._v("zarb inspect")]),e._v(" command you can see the private key.")]),e._v(" "),s("Tabs",{attrs:{type:"border-card"}},[s("Tab",{attrs:{label:"ü™ü Window"}},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("docker run -i --rm -v c:\\zarb\\:/zarb zarb/zarb key inspect -e /zarb/keystore/validator_key.json\n")])])])]),e._v(" "),s("Tab",{attrs:{label:"üêß Linux and üçè Mac"}},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("docker run -i --rm -v ~/zarb/:/zarb zarb/zarb key inspect -e /zarb/keystore/validator_key.json\n")])])])])],1),e._v(" "),s("p",[e._v("Copy the private key. You will need to paste in inside Ansible Vault in the next step.")]),e._v(" "),s("p",[e._v("Now let's create a vault and add the validator private key inside the vault.")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("ansible-vault create --vault-id vault@prompt tasks/vault.yml\n")])])]),s("p",[e._v("Set a strong password for the Vault.")]),e._v(" "),s("p",[e._v("It opens up an editor. Once you're inside, treat this like a normal variable file: add ---, then a\nnew variable:")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("---\nvault_validator_key: <validator_private_key>\n")])])]),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[e._v("TIP")]),e._v(" "),s("p",[e._v("The colon must be followed by a space.")])]),e._v(" "),s("p",[e._v("Ansible will encrypt the key and save inside "),s("code",[e._v("task/vault.yml")]),e._v(". You can open the "),s("code",[e._v("task/vault.yml")]),e._v(" and\nsee the content. It should be encrypted.")]),e._v(" "),s("p",[e._v("One more step, open the config file and update "),s("code",[e._v("MintbaseAddress")]),e._v(". This can be different from the\nvalidator address. You can also change other configs like "),s("code",[e._v("Moniker")]),e._v(", etc.")]),e._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[e._v("TIP")]),e._v(" "),s("p",[e._v("Address in Zarb starts with "),s("code",[e._v("zrb1...")])])]),e._v(" "),s("h2",{attrs:{id:"installing-ansible-plugins"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#installing-ansible-plugins"}},[e._v("#")]),e._v(" Installing Ansible plugins")]),e._v(" "),s("p",[e._v("Before deploying Zarb, you have to install two plugins for Ansible.")]),e._v(" "),s("p",[e._v("First install the "),s("code",[e._v("geerlingguy.docker")]),e._v(" plugin. This plugin will install docker for the server\nmachine.")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("ansible-galaxy install geerlingguy.docker\n")])])]),s("p",[e._v("And then install the "),s("code",[e._v("geerlingguy.ntp")]),e._v(" plugin. This plugin will synchronizing your server Time using\nNetwork Time Protocol (NTP).")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("ansible-galaxy install geerlingguy.ntp\n")])])]),s("h2",{attrs:{id:"deploy-zarb"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#deploy-zarb"}},[e._v("#")]),e._v(" Deploy Zarb")]),e._v(" "),s("p",[e._v("Now you can deploy Zarb by running deploy playbook:")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("ansible-playbook --ask-become-pass --vault-id tasks/vault@prompt tasks/deploy.yml\n\n")])])]),s("p",[e._v('Now you can check "http://<ip_address>:8080" to see if your node works fine and it\'s syncing with the\nmain network.')]),e._v(" "),s("h2",{attrs:{id:"update-zarb"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#update-zarb"}},[e._v("#")]),e._v(" Update Zarb")]),e._v(" "),s("p",[e._v("If you change the configuration or if you want to update the node version, run the deploy playbook\nagain. This will update the docker image and restart the node.")]),e._v(" "),s("p",[e._v("Welcome to Zarb network ü§ù")])],1)}),[],!1,null,null,null);a.default=r.exports}}]);